The code is primarily composed of preprocessing classes, the agent, and the episodic training of the model. The preprocessing contains frame extraction, rescaling, grayscaling, and adding certain frames to the buffer. The agent contains two networks along with a memory and experience replay functions. The run method sets a number of episodes to either train or test on, and saves the weights of the models along with the memory. To run the code, pip install the required functions and ensure that the Super Mario Bros gym environment is able to run with the given code. Then, run mario.py and adjust the training and testing episodes as needed.